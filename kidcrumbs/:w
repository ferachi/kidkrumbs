<template>
    <div id="selectSchool" class="d-flex">
        <div class="col-lg-8 col-xl-6">
        <h3>Select a school</h3>
        <div class="d-flex align-items-center flex-wrap">
            <div class="col-lg-6 col-12 p-2" v-for="school in schools" :key="school.id">
                <div class="p-3" :style="{background:school.color}">
                    <h5 class="font-weight- color_white m-0">
                        {{school.name}} 
                    </h5>
                    <p class="m-0 color_white"> <small class="color_white">{{school.motto}}</small></p>
                    <p class="color_white">{{school.brief_description}}</p>
                </div>
            </div>
        </div>
        </div>
    </div>
</template>
<script>
import {mapGetters, mapMutations} from 'vuex';
import ROLES from "../../../data_models/permissions";
export default {
    name : "SelectSchool",
    computed : {
        ...mapGetters('profile',{
            profile : 'getProfile'
        }),
        schools(){
            // administrative roles only
            let administrativeRoles = [ROLES.KIDKRUMBEE, ROLES.ADMINISTRATIVE ]

            // schools for which user has administrative roles
            let rolesFilter = _.filter( this.profile.schoolRoles, (sr) =>{
                                     return _.find(sr.roles, (role) => {
                                         return _.some(administrativeRoles, (ar) => role ==  ar);
                                     });
                                 });
            let schools = _.map(rolesFilter, (role) => {
                let school = _.find(this.profile.schools, (_school) => _school.slug == role.school);
                return school;
            });
            return schools;
        }
    }
}
</script>
<style lang="stylus">
#selectSchool
    .school 
        width 250px
        height 150px
</style>
